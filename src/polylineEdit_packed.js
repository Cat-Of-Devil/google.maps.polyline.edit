(function(a){google.maps.Polyline.prototype.runEdit===a&&(google.maps.Polyline.prototype.runEdit=function(b){function o(){this.setIcon(n)}function p(){this.setIcon(m)}function q(){var a=this.getPosition();a.marker=this,a.ghostMarker=c.getPath().getAt(this.inex).ghostMarker,c.getPath().setAt(this.inex,a),b&&j(this)}function r(){if(b){var d=c.getPath().getAt(this.inex),e=c.getPath().getAt(this.inex-1);d.ghostMarker!==a&&d.ghostMarker.setMap(null),c.getPath().removeAt(this.inex),e!==a&&(this.inex<c.getPath().getLength()?j(e.marker):(e.ghostMarker.setMap(null),e.ghostMarker=a))}else c.getPath().removeAt(this.inex);this.setMap(null),c.getPath().forEach(function(a,b){a.marker&&(a.marker.inex=b)}),c.getPath().getLength()===1&&c.getPath().pop().marker.setMap(null)}function s(a){var b=new google.maps.Marker({position:a,map:c.getMap(),icon:m,draggable:!0,raiseOnDrag:!1});return google.maps.event.addListener(b,"mouseover",o),google.maps.event.addListener(b,"mouseout",p),google.maps.event.addListener(b,"drag",q),google.maps.event.addListener(b,"rightclick",r),a.marker=b,b}b===a&&(b=!0);var c=this;if(b){var d=new google.maps.MarkerImage("css/ghostVertex.png",new google.maps.Size(11,11),new google.maps.Point(0,0),new google.maps.Point(6,6)),e=new google.maps.MarkerImage("css/ghostVertexOver.png",new google.maps.Size(11,11),new google.maps.Point(0,0),new google.maps.Point(6,6)),f=new google.maps.Polyline({map:this.getMap(),strokeColor:this.strokeColor,strokeOpacity:.2,strokeWeight:this.strokeWeight});function g(){this.setIcon(e)}function h(){this.setIcon(d)}function i(){f.getPath().getLength()===0&&f.setPath([this.marker.getPosition(),this.getPosition(),c.getPath().getAt(this.marker.inex+1)]),f.getPath().setAt(1,this.getPosition())}function j(b){var d=c.getPath().getAt(b.inex),e=c.getPath().getAt(b.inex-1);d!==a&&d.ghostMarker!==a&&(google.maps.geometry===a?d.ghostMarker.setPosition(new google.maps.LatLng(d.lat()+.5*(c.getPath().getAt(b.inex+1).lat()-d.lat()),d.lng()+.5*(c.getPath().getAt(b.inex+1).lng()-d.lng()))):d.ghostMarker.setPosition(google.maps.geometry.spherical.interpolate(d,c.getPath().getAt(b.inex+1),.5))),e!==a&&e.ghostMarker!==a&&(google.maps.geometry===a?e.ghostMarker.setPosition(new google.maps.LatLng(e.lat()+.5*(b.getPosition().lat()-e.lat()),e.lng()+.5*(b.getPosition().lng()-e.lng()))):e.ghostMarker.setPosition(google.maps.geometry.spherical.interpolate(e,b.getPosition(),.5)))}function k(){f.getPath().forEach(function(){f.getPath().pop()}),c.getPath().insertAt(this.marker.inex+1,this.getPosition()),s(c.getPath().getAt(this.marker.inex+1)).inex=this.marker.inex+1,j(this.marker),l(c.getPath().getAt(this.marker.inex+1)),c.getPath().forEach(function(a,b){a.marker&&(a.marker.inex=b)})}function l(b){if(b.marker.inex<c.getPath().getLength()-1){var e=new google.maps.Marker({position:google.maps.geometry===a?new google.maps.LatLng(b.lat()+.5*(c.getPath().getAt(b.marker.inex+1).lat()-b.lat()),b.lng()+.5*(c.getPath().getAt(b.marker.inex+1).lng()-b.lng())):google.maps.geometry.spherical.interpolate(b,c.getPath().getAt(b.marker.inex+1),.5),map:c.getMap(),icon:d,draggable:!0,raiseOnDrag:!1});return google.maps.event.addListener(e,"mouseover",g),google.maps.event.addListener(e,"mouseout",h),google.maps.event.addListener(e,"drag",i),google.maps.event.addListener(e,"dragend",k),b.ghostMarker=e,e.marker=b.marker,e}return null}}var m=new google.maps.MarkerImage("css/vertex.png",new google.maps.Size(11,11),new google.maps.Point(0,0),new google.maps.Point(6,6)),n=new google.maps.MarkerImage("css/vertexOver.png",new google.maps.Size(11,11),new google.maps.Point(0,0),new google.maps.Point(6,6));this.getPath().forEach(function(a,c){s(a).inex=c,b&&l(a)})}),google.maps.Polyline.prototype.stopEdit===a&&(google.maps.Polyline.prototype.stopEdit=function(){this.getPath().forEach(function(b,c){b.marker&&(b.marker.setMap(null),b.marker=a),b.ghostMarker&&(b.ghostMarker.setMap(null),b.ghostMarker=a)})})})()